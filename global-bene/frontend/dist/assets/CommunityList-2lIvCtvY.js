import{j as e}from"./ui-BaUVVAjf.js";import{r as s,b as w,L as g}from"./router-DiqerDgP.js";import{c as m}from"./index-DDEPdpRf.js";import"./vendor-Bzgz95E1.js";function L({communities:d,onJoin:N=()=>{}}){const[l,c]=s.useState(d||[]),[h,b]=s.useState(!1),[t,p]=s.useState({}),[n,f]=s.useState(""),[i,x]=s.useState(1),[o,v]=s.useState(1),[y]=s.useState(!d);w.useEffect(()=>{d||u()},[d,i,n]);const u=async()=>{b(!0);try{const a=y?{page:i,limit:20,search:n||void 0}:{},r=await m.getAllCommunities(a);c(r.data.communities||[]),r.data.pagination&&v(r.data.pagination.pages)}catch(a){console.error("Error loading communities:",a),c([])}finally{b(!1)}},k=a=>{a.preventDefault(),x(1),u()},j=async a=>{p({...t,[a]:!0});try{await m.toggleJoinCommunity(a);const r=await m.getAllCommunities();c(r.data.communities||[]),N()}catch(r){console.error("Error joining community:",r)}finally{p({...t,[a]:!1})}};return y?e.jsxs("div",{className:"max-w-4xl mx-auto my-10 px-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"Communities"}),e.jsxs("form",{onSubmit:k,className:"flex gap-2 mb-6",children:[e.jsx("input",{type:"text",value:n,onChange:a=>f(a.target.value),placeholder:"Search communities...",className:"flex-1 p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-semibold",children:"Search"})]})]}),e.jsx("div",{className:"space-y-4",children:h?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-orange-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading communities..."})]}):l.length===0?e.jsx("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:n?"No communities found matching your search.":"No communities yet."}):l.map(a=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[a.iconUrl?e.jsx("img",{src:a.iconUrl,alt:a.displayName,className:"w-12 h-12 rounded-full object-cover border-2 border-orange-500"}):e.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"g"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(g,{to:`/community/${a._id}`,className:"text-xl font-bold text-gray-900 dark:text-white hover:text-orange-500 transition-colors",children:["g/",a.name]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:a.displayName}),a.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[a.memberCount||0," members"]}),e.jsxs("span",{children:[a.postCount||0," posts"]}),e.jsxs("span",{children:["Created by u/",a.creator?.username||"Unknown"]})]})]})]}),e.jsx("div",{className:"ml-4",children:e.jsx("button",{onClick:()=>j(a._id),disabled:t[a._id],className:"px-4 py-2 text-sm font-semibold bg-orange-500 hover:bg-orange-600 text-white rounded-lg disabled:opacity-50",children:t[a._id]?"...":"Join"})})]})},a._id))}),o>1&&e.jsxs("div",{className:"flex justify-center items-center gap-4 mt-8",children:[e.jsx("button",{onClick:()=>x(a=>Math.max(1,a-1)),disabled:i<=1,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Page ",i," of ",o]}),e.jsx("button",{onClick:()=>x(a=>Math.min(o,a+1)),disabled:i>=o,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Next"})]})]}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Popular Communities"})}),e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:h?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"Loading communities..."}):(l||[]).length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"No communities yet"}):(l||[]).slice(0,5).map(a=>e.jsx("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[a.iconUrl?e.jsx("img",{src:a.iconUrl,alt:a.displayName,className:"w-8 h-8 rounded-full"}):e.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-xs",children:"g"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(g,{to:`/community/${a._id}`,className:"font-semibold text-gray-900 dark:text-white hover:text-orange-500 block truncate",children:["g/",a.name]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a.memberCount||0," members"]})]}),e.jsx("button",{onClick:()=>j(a._id),disabled:t[a._id],className:"px-3 py-1 text-xs font-semibold bg-orange-500 hover:bg-orange-600 text-white rounded-full disabled:opacity-50",children:t[a._id]?"...":"Join"})]})},a._id))}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:e.jsx(g,{to:"/communities",className:"text-sm text-orange-500 hover:text-orange-600 font-semibold block text-center",children:"View All Communities"})})]})}export{L as default};
