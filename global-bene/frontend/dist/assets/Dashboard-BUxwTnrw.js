import{j as e}from"./ui-BaUVVAjf.js";import{r,u as F,L as i}from"./router-DiqerDgP.js";import{p as R}from"./postService-B9nmksEV.js";import{c as V}from"./index-DDEPdpRf.js";import{a as w}from"./authService-BKeytffR.js";import{P as G}from"./PostCard-hk6ZiPN9.js";import J from"./CreatePost-DlGY833L.js";import Q from"./CreateCommunity-C9JzsyBe.js";import Y from"./CommunityList-2lIvCtvY.js";import"./vendor-Bzgz95E1.js";import"./CommentSection-BssdT6Od.js";import"./reportService-D7gKbnWI.js";function xe(){const[n,C]=r.useState([]),[f,S]=r.useState([]),[s,L]=r.useState(null),[M,P]=r.useState(!0),[x,k]=r.useState("hot"),[o,z]=r.useState(""),[q,N]=r.useState(!1),[l,u]=r.useState(1),[g,B]=r.useState(1),[T,m]=r.useState(!1),[$,b]=r.useState(!1),[K,X]=r.useState(null),H=F(),[h,j]=r.useState([]),[W,d]=r.useState(!1),[E,U]=r.useState(0),[_,D]=r.useState(0),[c,v]=r.useState(!0);r.useEffect(()=>{I(),p(),y()},[x,l]),r.useEffect(()=>{if(!o.trim()){j([]),d(!1),u(1);return}const t=setTimeout(async()=>{N(!0),u(1);try{const a=await w.searchUsers(o.trim());j(a.data.users||[]),d(!0)}catch{j([]),d(!1)}p().finally(()=>N(!1))},300);return()=>clearTimeout(t)},[o]),r.useEffect(()=>{s&&sessionStorage.setItem("user",JSON.stringify(s))},[s]);const I=async()=>{try{if(!!!sessionStorage.getItem("accessToken"))return;const a=await w.getMe();L(a.data)}catch(t){t?.response?.status!==401&&console.error("Error loading user:",t)}},p=async()=>{try{const t={sortBy:x,limit:20,page:l};o&&o.trim()&&(t.search=o.trim());const a=await R.getAllPosts(t);C(a.data.posts||[]),U(a.data.pagination?.total||0),B(a.data.pagination?.pages||1)}catch(t){console.error("Error loading posts:",t)}finally{P(!1)}},y=async()=>{try{const t=await V.getAllCommunities({limit:10});S(t.data.communities||[]),D(t.data.pagination?.total||0)}catch(t){console.error("Error loading communities:",t)}},O=()=>{m(!1),p(),y()},A=()=>{b(!1),y()};return M?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading posts..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 md:gap-4 py-2 md:py-0",children:[e.jsxs(i,{to:"/dashboard",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"G"})}),e.jsx("span",{className:"text-lg md:text-xl font-bold text-gray-900 dark:text-white",children:"GlobalBene"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-4",children:[e.jsx("button",{onClick:()=>v(!c),className:"flex items-center justify-center p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 transform hover:scale-110",title:c?"Close sidebar":"Open sidebar",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"relative flex-1 sm:flex-none",children:[e.jsx("input",{type:"text",value:o,onChange:t=>z(t.target.value),placeholder:"Search users or posts...",className:"w-full sm:w-64 px-3 py-2 rounded-full bg-gray-100 dark:bg-gray-700 text-sm text-gray-800 dark:text-gray-100 border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-orange-400",onFocus:()=>{(h.length||n.length)&&d(!0)},onBlur:()=>setTimeout(()=>d(!1),150)}),W&&(h.length>0||n.length>0)&&e.jsxs("div",{className:"absolute left-0 right-0 mt-1 bg-white dark:bg-gray-800 rounded shadow z-50 text-sm border border-gray-200 dark:border-gray-600 max-h-60 overflow-y-auto",children:[h.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-1 font-bold text-gray-700 dark:text-gray-200",children:"Users"}),h.map(t=>e.jsx("div",{className:"px-3 py-2 hover:bg-orange-50 dark:hover:bg-orange-900/20 cursor-pointer",onMouseDown:()=>H(`/profile/${t._id}`),children:e.jsxs("span",{className:"font-medium text-orange-600 dark:text-orange-300",children:["@",t.username]})},t._id))]}),n.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-1 font-bold text-gray-700 dark:text-gray-200",children:"Posts"}),n.filter(t=>t.title&&t.title.toLowerCase().includes(o.toLowerCase())).map(t=>e.jsx("div",{className:"px-3 py-2 hover:bg-orange-50 dark:hover:bg-orange-900/20 cursor-pointer",onMouseDown:()=>{const a=document.getElementById(`post-${t._id}`);a&&a.scrollIntoView({behavior:"smooth",block:"center"}),d(!1)},children:e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:t.title})},t._id))]}),!h.length&&!n.some(t=>t.title&&t.title.toLowerCase().includes(o.toLowerCase()))&&e.jsx("div",{className:"px-3 py-2 text-gray-500",children:"No results found."})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>m(!0),className:"flex-1 sm:flex-none px-3 md:px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-full font-semibold text-sm",children:"Create Post"}),e.jsx("button",{onClick:()=>b(!0),className:"flex-1 sm:flex-none px-3 md:px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-full font-semibold text-sm",children:"Create Community"})]}),s&&e.jsxs(i,{to:"/profile",className:"flex items-center space-x-2 justify-center sm:justify-start",children:[e.jsx("img",{src:s.profile?.avatarUrl||"https://www.gravatar.com/avatar/?d=mp",alt:s.username,className:"w-8 h-8 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 hidden sm:block",children:s.username})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-6",children:e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 md:gap-6",children:[e.jsxs("aside",{className:`w-64 space-y-4 transition-all duration-300 ease-in-out ${c?"block":"hidden"} xl:block ${c?"fixed left-0 top-0 h-full z-40 xl:relative xl:top-auto xl:left-auto xl:h-auto bg-gray-50 dark:bg-gray-900 xl:bg-transparent p-4 xl:p-0 shadow-lg xl:shadow-none":""}`,children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 sticky top-20 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:"Navigation"}),e.jsx("button",{onClick:()=>v(!1),className:"xl:hidden p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("nav",{className:"space-y-2",children:[e.jsxs(i,{to:"/dashboard",className:"flex items-center gap-3 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 rounded-lg transition-all duration-200",children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"})]}),"Home"]}),e.jsxs(i,{to:"/communities",className:"flex items-center gap-3 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 rounded-lg transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Communities"]}),e.jsxs(i,{to:"/create-post",className:"flex items-center gap-3 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 rounded-lg transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Post"]}),s&&e.jsxs(i,{to:"/profile",className:"flex items-center gap-3 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 rounded-lg transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Profile"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 text-sm",children:"Quick Stats"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Posts"}),e.jsx("span",{className:"font-bold text-orange-500 bg-orange-50 dark:bg-orange-900/20 px-2 py-1 rounded text-xs",children:E})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Communities"}),e.jsx("span",{className:"font-bold text-blue-500 bg-blue-50 dark:bg-blue-900/20 px-2 py-1 rounded text-xs",children:_})]}),s&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Your Posts"}),e.jsx("span",{className:"font-bold text-green-500 bg-green-50 dark:bg-green-900/20 px-2 py-1 rounded text-xs",children:s.posts?.length||0})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 text-sm",children:"Popular Communities"}),e.jsx("div",{className:"space-y-2",children:f.slice(0,5).map(t=>e.jsxs(i,{to:`/community/${t.name}`,className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-100 dark:bg-orange-900/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-orange-600 font-bold text-xs",children:"g"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:["g/",t.name]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.memberCount||0," members"]})]})]},t._id))})]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 xl:hidden transition-opacity duration-300",onClick:()=>v(!1)}),e.jsxs("div",{className:"w-full xl:flex-1 min-w-0 xl:order-2",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg mb-4 border border-gray-200 dark:border-gray-700 shadow-sm",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-3",children:[e.jsx("button",{onClick:()=>k("hot"),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200 ${x==="hot"?"bg-orange-100 dark:bg-orange-900/20 text-orange-600 shadow-sm":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-orange-500"}`,children:"ðŸ”¥ Hot"}),e.jsx("button",{onClick:()=>k("new"),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200 ${x==="new"?"bg-orange-100 dark:bg-orange-900/20 text-orange-600 shadow-sm":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-orange-500"}`,children:"â­ New"}),e.jsx("button",{onClick:()=>k("top"),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200 ${x==="top"?"bg-orange-100 dark:bg-orange-900/20 text-orange-600 shadow-sm":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-orange-500"}`,children:"â¬†ï¸ Top"})]})}),n.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-8 text-center shadow-sm",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No posts yet"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Be the first to create a post and start the conversation!"}),e.jsx("button",{onClick:()=>m(!0),className:"px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-semibold transition-all duration-200 transform hover:scale-105",children:"Create First Post"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:n.map(t=>e.jsx("div",{id:`post-${t._id}`,className:"transform transition-all duration-200 hover:scale-[1.01]",children:e.jsx(G,{post:t,onUpdate:p})},t._id))}),g>1&&e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u(t=>Math.max(1,t-1)),disabled:l<=1,className:`px-4 py-2 rounded-lg border text-sm font-semibold transition-all duration-200 ${l<=1?"opacity-50 cursor-not-allowed bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-600":"border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Previous"}),e.jsx("button",{onClick:()=>u(t=>Math.min(g,t+1)),disabled:l>=g,className:`px-4 py-2 rounded-lg border text-sm font-semibold transition-all duration-200 ${l>=g?"opacity-50 cursor-not-allowed bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-600":"border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Next"})]}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Page ",l," of ",g]})]})]})]}),e.jsxs("aside",{className:"w-full xl:w-80 space-y-4 xl:order-3",children:[e.jsx(Y,{communities:f,onJoin:y}),e.jsxs("div",{className:"xl:hidden bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 text-sm",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>m(!0),className:"flex flex-col items-center gap-2 p-3 bg-orange-50 dark:bg-orange-900/20 hover:bg-orange-100 dark:hover:bg-orange-900/30 rounded-lg transition-all duration-200",children:[e.jsx("svg",{className:"w-6 h-6 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"text-xs font-medium text-orange-600",children:"Create Post"})]}),e.jsxs("button",{onClick:()=>b(!0),className:"flex flex-col items-center gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg transition-all duration-200",children:[e.jsx("svg",{className:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("span",{className:"text-xs font-medium text-blue-600",children:"Create Community"})]})]})]})]})]})}),T&&e.jsx(J,{onClose:()=>m(!1),onSuccess:O,communities:f}),$&&e.jsx(Q,{onClose:()=>b(!1),onSuccess:A})]})}export{xe as default};
