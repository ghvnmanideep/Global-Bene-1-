import{j as e}from"./ui-BaUVVAjf.js";import{r as o}from"./router-DiqerDgP.js";import{c as N}from"./index-DDEPdpRf.js";import"./vendor-Bzgz95E1.js";function U({onClose:u,onSuccess:k}){const[a,x]=o.useState({name:"",displayName:"",description:"",rules:"",iconUrl:"",bannerUrl:"",isPrivate:!1,type:"general"}),[g,c]=o.useState(!1),[y,m]=o.useState(""),[b,w]=o.useState(null),[h,p]=o.useState(null),[C,F]=o.useState(null),[f,j]=o.useState(null),i=r=>{const s=r.target.type==="checkbox"?r.target.checked:r.target.value;x({...a,[r.target.name]:s})},v=async r=>{if(r.preventDefault(),c(!0),m(""),!/^[a-z0-9]+$/.test(a.name)){m("Community name must be lowercase alphanumeric only (no spaces or special characters)"),c(!1);return}try{const t={...a};if(b){const n=new FormData;n.append("image",b);const l=await(await fetch("http://localhost:5000/api/uploads/community-image",{method:"POST",body:n})).json();l.url&&(t.iconUrl=l.url)}if(h){const n=new FormData;n.append("image",h);const l=await(await fetch("http://localhost:5000/api/uploads/community-image",{method:"POST",body:n})).json();l.url&&(t.bannerUrl=l.url)}await N.createCommunity(t),k()}catch(t){m(t.response?.data?.message||"Error creating community")}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Create Community"}),e.jsx("button",{onClick:u,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:"âœ•"})]}),y&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:y}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name (lowercase, no spaces) *"}),e.jsx("input",{type:"text",name:"name",value:a.name,onChange:i,required:!0,pattern:"[a-z0-9]+",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"communityname"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["r/",a.name||"communityname"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Display Name *"}),e.jsx("input",{type:"text",name:"displayName",value:a.displayName,onChange:i,required:!0,maxLength:50,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Community Display Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type *"}),e.jsxs("select",{name:"type",value:a.type,onChange:i,required:!0,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"text",children:"Text Focus"}),e.jsx("option",{value:"image",children:"Image Focus"}),e.jsx("option",{value:"link",children:"Link Focus"}),e.jsx("option",{value:"mixed",children:"Mixed Content"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:a.description,onChange:i,rows:3,maxLength:500,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",placeholder:"What is this community about?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Community Rules (optional)"}),e.jsx("textarea",{name:"rules",value:a.rules,onChange:i,rows:4,maxLength:2e3,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",placeholder:"List your community rules, one per line..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Icon URL (optional)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:async r=>{const s=r.target.files[0];if(s){const t=new FormData;t.append("image",s);const d=await(await fetch("http://localhost:5000/api/uploads/community-image",{method:"POST",body:t})).json();d.url&&x(l=>({...l,iconUrl:d.url}))}w(s)},className:"w-full border mt-2 p-2"}),a.iconUrl&&e.jsxs("div",{className:"mt-2 flex items-center",children:[e.jsx("img",{src:a.iconUrl,alt:"Community Icon",className:"w-10 h-10 rounded-full mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.iconUrl})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Banner Image (optional)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:async r=>{const s=r.target.files[0];if(s){p(s);const t=new FileReader;t.onload=n=>j(n.target.result),t.readAsDataURL(s)}else p(null),j(null)},className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),f&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:f,alt:"Banner Preview",className:"w-full h-32 object-cover rounded-lg"})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"isPrivate",checked:a.isPrivate,onChange:i,className:"w-4 h-4 text-orange-500 border-gray-300 rounded focus:ring-orange-500"}),e.jsx("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Private community (members only)"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:u,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold disabled:opacity-50",children:g?"Creating...":"Create Community"})]})]})]})})})}export{U as default};
