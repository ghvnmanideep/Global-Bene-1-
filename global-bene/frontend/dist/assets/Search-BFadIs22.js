import{j as e}from"./ui-BaUVVAjf.js";import{r as d,b as f}from"./router-DiqerDgP.js";import{p as j}from"./postService-B9nmksEV.js";import{u as v}from"./userService-D_cfKFZn.js";import{P as N}from"./PostCard-hk6ZiPN9.js";import"./vendor-Bzgz95E1.js";import"./index-DDEPdpRf.js";import"./CommentSection-BssdT6Od.js";import"./authService-BKeytffR.js";import"./reportService-D7gKbnWI.js";function L(){const[a,g]=d.useState("posts"),[s,b]=d.useState(""),[c,r]=d.useState([]),[y,m]=d.useState(!1),[i,l]=d.useState(1),[n,p]=d.useState(1),x=async t=>{t?.preventDefault(),m(!0);try{if(a==="posts"){let o={page:i,limit:10};if(s.startsWith("#")){const h=s.substring(1).trim();if(h)o.tag=h;else{r([]),m(!1);return}}else o.search=s;const u=await j.getAllPosts(o);r(u.data.posts),p(u.data.pagination.pages)}else{const o=await v.searchUsers({search:s,page:i,limit:10});r(o.data.users),p(o.data.pagination.pages)}}catch{r([])}finally{m(!1)}};return f.useEffect(()=>{s&&x()},[i,a]),e.jsxs("div",{className:"max-w-3xl mx-auto py-10 px-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Search"}),e.jsxs("div",{className:"flex gap-4 items-center mb-6 justify-center",children:[e.jsx("button",{onClick:()=>{g("posts"),r([]),l(1)},className:`px-4 py-2 rounded font-semibold ${a==="posts"?"bg-orange-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200"}`,children:"Posts"}),e.jsx("button",{onClick:()=>{g("users"),r([]),l(1)},className:`px-4 py-2 rounded font-semibold ${a==="users"?"bg-orange-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200"}`,children:"Users"})]}),e.jsxs("form",{onSubmit:x,className:"flex gap-2 mb-8 justify-center",children:[e.jsx("input",{value:s,onChange:t=>b(t.target.value),required:!0,className:"w-2/3 p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:a==="posts"?"Search posts or use #tag for tag search...":`Search ${a}...`}),e.jsx("button",{type:"submit",className:"bg-orange-500 text-white px-4 py-2 rounded font-bold",children:"Search"})]}),y?e.jsx("div",{className:"text-center",children:"Loading..."}):c.length===0&&s?e.jsx("div",{className:"text-center text-gray-500",children:"No results found."}):a==="posts"?e.jsx("div",{className:"space-y-4",children:c.map(t=>e.jsx(N,{post:t,onUpdate:x},t._id))}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:c.map(t=>e.jsxs("div",{className:"flex items-center py-4 gap-4",children:[e.jsx("img",{src:t.profile?.avatarUrl||"https://www.gravatar.com/avatar/?d=mp",alt:t.username,className:"w-12 h-12 rounded-full object-cover border-2 border-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:t.username}),e.jsx("div",{className:"text-gray-500 text-sm truncate",children:t.email}),e.jsx("span",{className:"inline-block mt-1 px-2 py-1 text-xs rounded bg-blue-100 text-blue-800",children:t.role})]})]},t._id))}),n>1&&e.jsxs("div",{className:"flex gap-3 justify-center mt-8",children:[e.jsx("button",{disabled:i<=1,onClick:()=>l(t=>Math.max(1,t-1)),className:"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 disabled:opacity-50",children:"Prev"}),e.jsxs("span",{className:"text-sm",children:["Page ",i," of ",n]}),e.jsx("button",{disabled:i>=n,onClick:()=>l(t=>Math.min(n,t+1)),className:"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 disabled:opacity-50",children:"Next"})]})]})}export{L as default};
