import{j as t}from"./ui-BaUVVAjf.js";import{r as o,L as M}from"./router-DiqerDgP.js";import{a as $}from"./index-DDEPdpRf.js";import"./vendor-Bzgz95E1.js";const i=$,l={getNotifications:s=>i.get("/notifications",{params:s}),markAsRead:s=>i.put(`/notifications/${s}/read`),markAllAsRead:()=>i.put("/notifications/read-all"),getUnreadCount:()=>i.get("/notifications/unread-count")};function U(){const[s,n]=o.useState([]),[y,p]=o.useState(!0),[c,m]=o.useState(0),[d,f]=o.useState(1),[b,N]=o.useState(!0);o.useEffect(()=>{k(),j()},[d]);const k=async()=>{try{const r=(await l.getNotifications({page:d,limit:20})).data.notifications||[];n(d===1?r:a=>[...a,...r]),N(r.length===20)}catch(e){console.error("Error loading notifications:",e)}finally{p(!1)}},j=async()=>{try{const e=await l.getUnreadCount();m(e.data.unreadCount||0)}catch(e){console.error("Error loading unread count:",e)}},u=async e=>{try{await l.markAsRead(e),n(r=>r.map(a=>a._id===e?{...a,isRead:!0}:a)),m(r=>Math.max(0,r-1))}catch(r){console.error("Error marking as read:",r)}},w=async()=>{try{await l.markAllAsRead(),n(e=>e.map(r=>({...r,isRead:!0}))),m(0)}catch(e){console.error("Error marking all as read:",e)}},v=e=>{const r=new Date,a=new Date(e),A=r-a,x=Math.floor(A/6e4),g=Math.floor(x/60),h=Math.floor(g/24);return h>0?`${h}d ago`:g>0?`${g}h ago`:x>0?`${x}m ago`:"just now"},R=e=>{switch(e){case"comment":return"ðŸ’¬";case"upvote":return"â¬†ï¸";case"downvote":return"â¬‡ï¸";case"follow":return"ðŸ‘¤";case"mention":return"@";case"reply":return"â†©ï¸";default:return"ðŸ””"}},C=e=>e.relatedPost?`/post/${e.relatedPost._id}`:e.relatedUser?`/profile/${e.relatedUser._id}`:e.relatedCommunity?`/community/${e.relatedCommunity._id}`:"#";return y&&d===1?t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading notifications..."})]})}):t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:t.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-8",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[t.jsx("div",{className:"px-4 md:px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[t.jsxs("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-white",children:["Notifications",c>0&&t.jsx("span",{className:"ml-2 bg-orange-500 text-white text-sm px-2 py-1 rounded-full",children:c})]}),c>0&&t.jsx("button",{onClick:w,className:"px-3 md:px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-full font-semibold text-sm transition w-full sm:w-auto",children:"Mark All as Read"})]})}),t.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.length===0?t.jsxs("div",{className:"px-4 md:px-6 py-8 text-center",children:[t.jsx("div",{className:"text-4xl mb-4",children:"ðŸ””"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No notifications yet"}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-2",children:"When someone interacts with your posts or follows you, you'll see it here."})]}):s.map(e=>t.jsx("div",{className:`px-4 md:px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition ${e.isRead?"":"bg-orange-50 dark:bg-orange-900/10"}`,children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"text-xl md:text-2xl",children:R(e.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx(M,{to:C(e),onClick:()=>!e.isRead&&u(e._id),className:"block",children:t.jsx("p",{className:"text-gray-900 dark:text-white text-sm md:text-base",children:e.message})}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:v(e.createdAt)})]}),!e.isRead&&t.jsx("button",{onClick:()=>u(e._id),className:"text-orange-500 hover:text-orange-600 text-xs md:text-sm font-medium whitespace-nowrap",children:"Mark as read"})]})},e._id))}),b&&t.jsx("div",{className:"px-4 md:px-6 py-4 border-t border-gray-200 dark:border-gray-700 text-center",children:t.jsx("button",{onClick:()=>f(e=>e+1),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-full font-semibold text-sm transition w-full md:w-auto",children:"Load More"})})]})})})}export{U as default};
