import{j as e}from"./ui-BaUVVAjf.js";import{r as d}from"./router-DiqerDgP.js";import{a as h}from"./authService-BKeytffR.js";import"./vendor-Bzgz95E1.js";import"./index-DDEPdpRf.js";const R=()=>{const[a,n]=d.useState([]),[o,c]=d.useState(!0),[m,p]=d.useState(null),[t,x]=d.useState(1),[l,g]=d.useState(null);d.useEffect(()=>{u()},[t]);const u=async()=>{try{c(!0);const s=await h.admin.getReportedPosts({page:t,limit:20});n(s.data.posts),g(s.data.pagination)}catch(s){p("Failed to load reported posts"),console.error("Reported posts fetch error:",s)}finally{c(!1)}},b=async(s,r)=>{if(window.confirm(`Are you sure you want to delete the reported post "${r}"?`))try{await h.admin.deletePost(s),n(a.filter(i=>i._id!==s))}catch(i){alert("Failed to delete post"),console.error("Delete post error:",i)}},j=async s=>{window.confirm("Are you sure you want to dismiss this spam report?")&&n(a.filter(r=>r._id!==s))};return o&&t===1?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Spam Reports"}),e.jsx("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"Back to Dashboard"})]}),m&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-600",children:m})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Spam Report Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:a.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Reported Posts"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:a.reduce((s,r)=>s+(r.spamReports?.length||0),0)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Reports"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-500",children:a.filter(s=>s.isHidden).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Auto-Hidden Posts"})]})]})]}),e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsx("div",{className:`bg-white rounded-lg shadow p-6 ${s.isHidden?"border-l-4 border-red-500":""}`,children:e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mr-3",children:s.title}),s.isHidden&&e.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full",children:"Hidden"})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["By ",e.jsx("span",{className:"font-medium",children:s.author?.username})," in"," ",e.jsx("span",{className:"font-medium",children:s.community?.name||"General"}),e.jsx("span",{className:"ml-2 text-xs bg-gray-100 px-2 py-1 rounded",children:s.type})]}),e.jsx("p",{className:"text-gray-700 line-clamp-3 mb-3",children:s.content?.text||s.content||"No content"}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-red-800 mb-2",children:["Spam Reports (",s.spamReports?.length||0,")"]}),e.jsxs("div",{className:"space-y-2",children:[s.spamReports?.slice(0,3).map((r,i)=>e.jsxs("div",{className:"text-xs text-red-700",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",r.reason," •",e.jsx("span",{className:"ml-2 font-medium",children:"Reported:"})," ",new Date(r.reportedAt).toLocaleDateString()]},i)),s.spamReports?.length>3&&e.jsxs("div",{className:"text-xs text-red-600 font-medium",children:["+",s.spamReports.length-3," more reports"]})]})]}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:["Posted: ",new Date(s.createdAt).toLocaleDateString()," •",s.upvotes," upvotes • ",s.commentCount," comments"]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[e.jsx("button",{onClick:()=>b(s._id,s.title),className:"px-3 py-2 bg-red-500 text-white text-sm rounded hover:bg-red-600",children:"Delete Post"}),e.jsx("button",{onClick:()=>j(s._id),className:"px-3 py-2 bg-green-500 text-white text-sm rounded hover:bg-green-600",children:"Dismiss Report"})]})]})},s._id))}),l&&l.pages>1&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>x(Math.max(1,t-1)),disabled:t===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:["Page ",t," of ",l.pages]}),e.jsx("button",{onClick:()=>x(Math.min(l.pages,t+1)),disabled:t===l.pages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})}),a.length===0&&!o&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"✅"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Spam Reports"}),e.jsx("p",{className:"text-gray-500",children:"All posts are clean! No spam reports to review."})]})]})};export{R as default};
