import{j as e}from"./ui-BaUVVAjf.js";import{r as l}from"./router-DiqerDgP.js";import{a as x}from"./authService-BKeytffR.js";import"./vendor-Bzgz95E1.js";import"./index-DDEPdpRf.js";const A=()=>{const[c,m]=l.useState([]),[u,h]=l.useState(!0),[w,g]=l.useState(null),[d,y]=l.useState(""),[o,b]=l.useState("all"),[s,n]=l.useState(1),[a,f]=l.useState(null);l.useEffect(()=>{p()},[d,o,s]);const p=async()=>{try{h(!0);const t={page:s,limit:20};d&&(t.search=d),o!=="all"&&(t.role=o);const r=await x.admin.getAllUsers(t);m(r.data.users),f(r.data.pagination)}catch(t){g("Failed to load users"),console.error("Users fetch error:",t)}finally{h(!1)}},j=async(t,r)=>{if(window.confirm(`Are you sure you want to delete user "${r}"? This action cannot be undone.`))try{await x.admin.deleteUser(t),m(c.filter(i=>i._id!==t))}catch(i){alert("Failed to delete user"),console.error("Delete user error:",i)}},v=async(t,r)=>{try{await x.admin.updateUserRole(t,r),m(c.map(i=>i._id===t?{...i,role:r}:i))}catch(i){alert("Failed to update user role"),console.error("Role update error:",i)}};return u&&s===1?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"User Management"}),e.jsx("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"Back to Dashboard"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsx("input",{type:"text",value:d,onChange:t=>y(t.target.value),placeholder:"Search by username or email",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role Filter"}),e.jsxs("select",{value:o,onChange:t=>b(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"user",children:"Users"}),e.jsx("option",{value:"admin",children:"Admins"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{n(1),p()},className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600",children:"Search"})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:t.username?.charAt(0).toUpperCase()||"U"}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.username})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:t.role||"user",onChange:r=>v(t._id,r.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>j(t._id,t.username),className:"text-red-600 hover:text-red-900 mr-4",children:"Delete"})})]},t._id))})]})}),a&&a.pages>1&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>n(Math.max(1,s-1)),disabled:s===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>n(Math.min(a.pages,s+1)),disabled:s===a.pages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(s-1)*a.limit+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(s*a.limit,a.total)})," of"," ",e.jsx("span",{className:"font-medium",children:a.total})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>n(Math.max(1,s-1)),disabled:s===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>n(Math.min(a.pages,s+1)),disabled:s===a.pages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})})]})]})]})]})};export{A as default};
