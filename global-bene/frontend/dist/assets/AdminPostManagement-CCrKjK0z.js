import{j as e}from"./ui-BaUVVAjf.js";import{r as s}from"./router-DiqerDgP.js";import{a as u}from"./authService-BKeytffR.js";import"./vendor-Bzgz95E1.js";import"./index-DDEPdpRf.js";const E=()=>{const[m,p]=s.useState([]),[h,g]=s.useState(!0),[k,y]=s.useState(null),[o,f]=s.useState(""),[i,j]=s.useState(""),[c,v]=s.useState("all"),[d,N]=s.useState("all"),[a,x]=s.useState(1),[l,w]=s.useState(null);s.useEffect(()=>{b()},[o,i,c,d,a]);const b=async()=>{try{g(!0);const t={page:a,limit:20};o&&(t.search=o),i&&(t.author=i),c!=="all"&&(t.type=c),d!=="all"&&(t.spamStatus=d);const r=await u.admin.getAllPosts(t);p(r.data.posts),w(r.data.pagination)}catch(t){y("Failed to load posts"),console.error("Posts fetch error:",t)}finally{g(!1)}},S=async(t,r)=>{if(window.confirm(`Are you sure you want to delete the post "${r}"? This action cannot be undone.`))try{await u.admin.deletePost(t),p(m.filter(n=>n._id!==t))}catch(n){alert("Failed to delete post"),console.error("Delete post error:",n)}},P=async t=>{const r=prompt("Enter reason for reporting this post as spam:");if(r)try{await u.admin.reportPost(t,r),alert("Post reported successfully")}catch(n){alert("Failed to report post"),console.error("Report post error:",n)}};return h&&a===1?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Post Management"}),e.jsx("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"Back to Dashboard"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsx("input",{type:"text",value:o,onChange:t=>f(t.target.value),placeholder:"Search posts",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Author"}),e.jsx("input",{type:"text",value:i,onChange:t=>j(t.target.value),placeholder:"Author username",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),e.jsxs("select",{value:c,onChange:t=>v(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"image",children:"Image"}),e.jsx("option",{value:"link",children:"Link"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spam Status"}),e.jsxs("select",{value:d,onChange:t=>N(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"not_spam",children:"Not Spam"}),e.jsx("option",{value:"might_be_spam",children:"Might Be Spam"}),e.jsx("option",{value:"spam",children:"Spam"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{x(1),b()},className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600",children:"Search"})})]})}),e.jsx("div",{className:"space-y-4",children:m.map(t=>e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t.title}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["By ",e.jsx("span",{className:"font-medium",children:t.author?.username})," in"," ",e.jsx("span",{className:"font-medium",children:t.community?.name||"General"}),e.jsx("span",{className:"ml-2 text-xs bg-gray-100 px-2 py-1 rounded",children:t.type}),e.jsx("span",{className:`ml-2 text-xs px-2 py-1 rounded ${t.spamStatus==="spam"?"bg-red-100 text-red-800":t.spamStatus==="might_be_spam"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:t.spamStatus==="not_spam"?"Clean":t.spamStatus==="might_be_spam"?"Suspicious":"Spam"})]}),e.jsx("p",{className:"text-gray-700 line-clamp-3",children:t.content?.text||t.content||"No content"}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[new Date(t.createdAt).toLocaleDateString()," •",t.upvotes," upvotes • ",t.commentCount," comments"]})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>P(t._id),className:"px-3 py-1 bg-yellow-500 text-white text-sm rounded hover:bg-yellow-600",children:"Report Spam"}),e.jsx("button",{onClick:()=>S(t._id,t.title),className:"px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600",children:"Delete"})]})]})},t._id))}),l&&l.pages>1&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>x(Math.max(1,a-1)),disabled:a===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:["Page ",a," of ",l.pages]}),e.jsx("button",{onClick:()=>x(Math.min(l.pages,a+1)),disabled:a===l.pages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})}),m.length===0&&!h&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No posts found matching your criteria."})})]})};export{E as default};
