import{j as e}from"./ui-BaUVVAjf.js";import{r as o,u as v}from"./router-DiqerDgP.js";import{a as m}from"./authService-BKeytffR.js";import"./vendor-Bzgz95E1.js";import"./index-DDEPdpRf.js";function C(){const[n,p]=o.useState(null),[x,c]=o.useState(""),[b,h]=o.useState(null),[a,g]=o.useState({username:"",bio:"",mobile:"",gender:"",dob:""}),[l,d]=o.useState(""),i=v();o.useEffect(()=>{m.getMe().then(t=>{const r=t.data;p(r),g({username:r.username||"",bio:r.profile?.bio||"",mobile:r.profile?.mobile||"",gender:r.profile?.gender||"",dob:r.profile?.dob?r.profile.dob.slice(0,10):""}),c(r.profile?.avatarUrl||"")}).catch(()=>i("/login"))},[i]);const s=t=>{g(r=>({...r,[t.target.name]:t.target.value}))},f=t=>{const r=t.target.files[0];if(h(r),r){const u=new FileReader;u.onloadend=()=>c(u.result),u.readAsDataURL(r)}},y=async t=>{t.preventDefault(),d("");try{const r=new FormData;r.append("username",a.username),r.append("bio",a.bio),r.append("mobile",a.mobile),r.append("gender",a.gender),r.append("dob",a.dob),b&&r.append("avatar",b),await m.updateProfile(r),d("✅ Profile updated successfully!"),setTimeout(()=>i("/dashboard"),1500)}catch(r){d(r.response?.data?.message||r.response?.data?.error||"Error updating profile")}};return n?e.jsxs("div",{className:"max-w-xl mx-auto mt-10 p-6 bg-white dark:bg-gray-800 shadow rounded border border-gray-300 dark:border-gray-700",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6 text-gray-900 dark:text-gray-100",children:"Edit Profile"}),n&&n.googleId&&e.jsx("div",{className:"bg-blue-100 text-blue-800 px-2 py-1 mb-6 rounded text-sm",children:"Password cannot be set/changed for accounts created with Google login."}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx("img",{src:x||"https://www.gravatar.com/avatar/?d=mp",alt:"Avatar Preview",className:"w-24 h-24 rounded-full object-cover border-2 border-blue-500"}),e.jsxs("label",{className:"cursor-pointer px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-semibold shadow",children:["Upload Avatar",e.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block mb-1 font-medium text-gray-700 dark:text-gray-300",children:"Username"}),e.jsx("input",{type:"text",id:"username",name:"username",value:a.username,onChange:s,className:"w-full border border-gray-300 dark:border-gray-600 rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",placeholder:"Enter your username"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bio",className:"block mb-1 font-medium text-gray-700 dark:text-gray-300",children:"Bio"}),e.jsx("textarea",{id:"bio",name:"bio",rows:"3",value:a.bio,onChange:s,className:"w-full border border-gray-300 dark:border-gray-600 rounded p-2 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",placeholder:"Tell us about yourself"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mobile",className:"block mb-1 font-medium text-gray-700 dark:text-gray-300",children:"Mobile"}),e.jsx("input",{type:"tel",id:"mobile",name:"mobile",value:a.mobile,onChange:s,placeholder:"+1 234 567 8900",className:"w-full border border-gray-300 dark:border-gray-600 rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gender",className:"block mb-1 font-medium text-gray-700 dark:text-gray-300",children:"Gender"}),e.jsxs("select",{id:"gender",name:"gender",value:a.gender,onChange:s,className:"w-full border border-gray-300 dark:border-gray-600 rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",children:[e.jsx("option",{value:"",children:"Prefer not to say"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dob",className:"block mb-1 font-medium text-gray-700 dark:text-gray-300",children:"Date of Birth"}),e.jsx("input",{type:"date",id:"dob",name:"dob",value:a.dob,onChange:s,className:"w-full border border-gray-300 dark:border-gray-600 rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"})]}),e.jsx("button",{type:"submit",className:"w-full py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded shadow transition",children:"Save Changes"}),l&&e.jsx("p",{className:`mt-4 text-center rounded px-3 py-1 ${l.includes("✅")?"bg-green-200 text-green-800":"bg-red-200 text-red-800"}`,children:l})]})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen text-gray-700 dark:text-gray-300 dark:bg-gray-900 bg-gray-100",children:"Loading profile..."})}export{C as default};
